<center><font color=#000 size=5>购物车优惠券相关算法</font></center>

<center><font color="#999" size=2> 分类： 前端 | 记录 | 业务相关 </font></center>

<center><font color="#999" size=2>日期：2021-10-12</font></center>

---



### 2021-10-12

1. 购物车页面倒计时特别大

   解决：没有加入倒计时超过三天就不现实原则

   

2. 购物车显示的优惠信息和详情页不同

   解决：前端筛选可以使用的优惠券的规则错误，和后端筛选结果不一致导致

   

3. 购物车下单判断是否可用cod支付方式接口数据错误

   解决: 没有计算优惠券优惠的相关金额在内

   

4. 购物车内显示有可用的优惠券下单页缺不显示

   未复现：可能是为题2 导致，修改后戏剧观察

   

5. 计算商品总价会出现店铺商品金额总和为负数，进而影响后去运算

   已解决：店铺优惠后商品金额最小为0



### 2021-10-13

1. 优惠券重复使用

   解决： 优惠券出现冲突无法使用，当重置优惠券为没有可以使用的优惠券时，没有正确重置相关优惠

   

2. 单个商品结算优惠券弹窗显示优惠金额错误

   解决：没有正确的计算单个商品的总和导致计算错误

   

3. 店铺优惠券不可用时差距金额显示错误

   解决： 没有正确判断是当前店铺的商品总和导致错误



4. 计算下单合计金额方法显示错误

   解决：计算商品总额时，使用的是优惠后的商品金额相加导致计算错误



5. 单个商品下单优惠券弹窗内部没有变化

   解决：没有正确的传入修改后的商品总金额，导致一直按照单个商品没有运费计算



6. 单个商品下单不可用优惠券金额显示错误

   解决：计算差距金额时没有算入运费



7. 多个相同id优惠券被判断为同一张导致错误

   解决：增加相同优惠券判断条件，开始时间，结束时间

 

### 2021-10-14

1. 优惠券重复使用

   解决：修改了相同优惠券判断规则，导则出现判断初五，没有正确的判断同一张优惠券



2. 当有一个商品多个sku下单时提交字段错误导致计算出错

   解决：修改相关字段